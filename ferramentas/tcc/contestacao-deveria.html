<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desconstruindo o "Deveria" | Bruno de Souza</title>
    
    <script>
        if(localStorage.getItem('logado') !== 'sim') {
            window.location.href = "../../login.html";
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            --bg-color: #f0f8ff;
            --primary: #6c5ce7;
            --primary-dark: #5849be;
            --accent: #00cec9;
            --text: #2d3436;
            --card-bg: #ffffff;
            --range-track: #dfe6e9;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#dfe6e9 2px, transparent 2px);
            background-size: 20px 20px;
            margin: 0; padding: 20px;
            color: var(--text);
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
        }

        /* --- HEADER --- */
        header {
            text-align: center; margin-bottom: 30px;
            background: white; padding: 20px 40px;
            border-radius: 20px; border: 3px dashed var(--primary);
            box-shadow: 8px 8px 0 rgba(0,0,0,0.05);
            max-width: 800px; width: 100%; position: relative;
        }

        header h1 { color: var(--primary); margin: 0; font-weight: 800; font-size: 1.8rem; }
        .subtitle { color: #636e72; font-weight: 600; margin-top: 5px; }

        .btn-print {
            position: absolute; top: 20px; right: 20px;
            background: none; border: 2px solid var(--primary); color: var(--primary);
            padding: 8px 15px; border-radius: 20px; font-weight: 700; cursor: pointer; transition: 0.3s;
        }
        .btn-print:hover { background: var(--primary); color: white; }

        /* --- CONTAINER DO WIZARD --- */
        .wizard-container {
            width: 100%; max-width: 800px;
            background: white; border-radius: 25px;
            padding: 40px; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border: 1px solid #eee; position: relative; overflow: hidden;
        }

        /* Barra de Progresso */
        .progress-bar {
            width: 100%; height: 10px; background: #f1f2f6;
            border-radius: 5px; margin-bottom: 30px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; background: var(--accent); width: 25%;
            transition: width 0.4s ease; border-radius: 5px;
        }

        /* Passos */
        .step { display: none; animation: fadeIn 0.5s ease; }
        .step.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Inputs e Labels */
        label { display: block; font-weight: 700; margin-bottom: 10px; color: var(--text); font-size: 1.1rem; }
        
        .input-group { margin-bottom: 25px; }
        
        input[type="text"], textarea {
            width: 100%; padding: 15px; border: 2px solid #dfe6e9;
            border-radius: 12px; font-family: inherit; font-size: 1rem;
            transition: 0.3s; background: #fdfdfd; resize: vertical;
        }
        input[type="text"]:focus, textarea:focus { border-color: var(--primary); outline: none; background: white; }

        /* Range Slider Customizado */
        .range-container { margin: 20px 0; }
        .range-header { display: flex; justify-content: space-between; font-weight: bold; color: var(--primary); }
        
        input[type=range] {
            width: 100%; -webkit-appearance: none; background: transparent; margin: 15px 0;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 10px; background: var(--range-track); border-radius: 5px;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 25px; width: 25px; border-radius: 50%;
            background: var(--primary); cursor: pointer; margin-top: -8px; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Botões de Navegação */
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 30px; }
        
        .btn {
            padding: 12px 30px; border-radius: 30px; font-weight: 800; cursor: pointer;
            border: none; font-size: 1rem; transition: 0.3s; display: flex; align-items: center; gap: 10px;
        }
        .btn-prev { background: #dfe6e9; color: #636e72; }
        .btn-prev:hover { background: #b2bec3; }
        
        .btn-next { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3); }
        .btn-next:hover { background: var(--primary-dark); transform: translateY(-2px); }

        /* --- RESULTADO --- */
        .result-card {
            background: #f8f9fa; border: 2px dashed var(--primary);
            border-radius: 20px; padding: 30px; text-align: center;
        }
        
        .comparison-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;
        }
        
        .comp-box {
            background: white; padding: 20px; border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        
        .comp-title { font-size: 0.9rem; text-transform: uppercase; color: #b2bec3; font-weight: 800; margin-bottom: 10px; }
        .comp-val { font-size: 2.5rem; font-weight: 800; color: var(--primary); }
        .comp-label { font-size: 1.1rem; font-weight: 600; color: var(--text); }

        .transformation-box {
            background: #e0f7fa; color: #006064; padding: 20px;
            border-radius: 15px; margin-top: 20px; border: 2px solid #4dd0e1;
        }

        .btn-back-home {
            margin-top: 40px; color: #b2bec3; text-decoration: none; font-weight: 600;
        }
        .btn-back-home:hover { color: var(--primary); }

        /* Responsivo */
        @media (max-width: 600px) {
            .wizard-container { padding: 20px; }
            .comparison-grid { grid-template-columns: 1fr; }
            header h1 { font-size: 1.5rem; }
            .btn-print span { display: none; }
        }

        /* Impressão */
        @media print {
            header button, .nav-buttons, .btn-back-home { display: none !important; }
            body { background: white; }
            .wizard-container { box-shadow: none; border: none; padding: 0; }
            .step { display: block !important; margin-bottom: 30px; border-bottom: 1px dashed #ccc; padding-bottom: 20px; }
            .progress-bar { display: none; }
            input, textarea { border: 1px solid #ccc; background: none !important; }
        }
    </style>
</head>
<body>

    <header data-aos="fade-down">
        <button class="btn-print" onclick="window.print()"><i class="fa-solid fa-print"></i> <span>Imprimir</span></button>
        <h1>Desconstruindo o "Deveria"</h1>
        <div class="subtitle">Ferramenta Cognitiva (Leahy)</div>
    </header>

    <div class="wizard-container" data-aos="fade-up">
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="step active" id="step1">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-magnifying-glass"></i> Passo 1: O Peso da Regra</h2>
            
            <div class="input-group">
                <label>Qual é a afirmação do tipo "deveria" que está te incomodando?</label>
                <input type="text" id="statement" placeholder='Ex: "Eu deveria ter feito melhor", "Eu devo ser perfeito"...'>
            </div>

            <div class="range-container">
                <div class="range-header">
                    <span>Quanto você acredita nisso?</span>
                    <span id="beliefVal1">0%</span>
                </div>
                <input type="range" id="belief1" min="0" max="100" value="0" oninput="updateRange('belief1', 'beliefVal1')">
            </div>

            <div class="input-group">
                <label>Qual emoção você sente ao pensar nisso?</label>
                <input type="text" id="emotion" placeholder="Ex: Culpa, Tristeza, Ansiedade...">
            </div>

            <div class="range-container">
                <div class="range-header">
                    <span>Intensidade da Emoção:</span>
                    <span id="emotionVal1">0%</span>
                </div>
                <input type="range" id="emotion1" min="0" max="100" value="0" oninput="updateRange('emotion1', 'emotionVal1')">
            </div>

            <div class="nav-buttons" style="justify-content: flex-end;">
                <button class="btn btn-next" onclick="nextStep(2)">Continuar <i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </div>

        <div class="step" id="step2">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-scale-balanced"></i> Passo 2: Custo-Benefício</h2>
            
            <div class="input-group">
                <label>Quais os BENEFÍCIOS de pensar assim?</label>
                <textarea id="benefits" rows="3" placeholder="Isso me ajuda em algo? Me motiva?"></textarea>
            </div>

            <div class="input-group">
                <label style="color:#d63031">Quais os CUSTOS de pensar assim?</label>
                <textarea id="costs" rows="3" placeholder="Isso me deixa ansioso? Baixa minha autoestima?"></textarea>
            </div>

            <div class="input-group">
                <label>Quem estabeleceu essa regra na sua vida?</label>
                <input type="text" id="source" placeholder="Meus pais? A sociedade? Eu mesmo?">
            </div>

            <div class="nav-buttons">
                <button class="btn btn-prev" onclick="prevStep(1)"><i class="fa-solid fa-arrow-left"></i> Voltar</button>
                <button class="btn btn-next" onclick="nextStep(3)">Continuar <i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </div>

        <div class="step" id="step3">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-glasses"></i> Passo 3: Mudando a Lente</h2>
            
            <div class="input-group">
                <label>Você aplica esta regra a todas as pessoas? Por que não?</label>
                <textarea id="applyOthers" rows="3" placeholder="Se um amigo fizesse o mesmo, você o julgaria tanto quanto se julga?"></textarea>
            </div>

            <div class="input-group">
                <label style="color:var(--primary)">Reexpresse esta regra como uma PREFERÊNCIA em vez de "Dever":</label>
                <input type="text" id="preference" placeholder='Ex: "Eu preferiria ter feito melhor, mas sou humano..."'>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-prev" onclick="prevStep(2)"><i class="fa-solid fa-arrow-left"></i> Voltar</button>
                <button class="btn btn-next" onclick="nextStep(4)">Continuar <i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </div>

        <div class="step" id="step4">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-rotate"></i> Passo 4: Conclusão</h2>
            
            <div class="input-group">
                <label>Qual seria uma expectativa mais razoável e realista?</label>
                <textarea id="reasonable" rows="3" placeholder="O que seria justo esperar de si mesmo nesta situação?"></textarea>
            </div>

            <hr style="border:0; border-top:1px dashed #ccc; margin:20px 0;">

            <p style="text-align:center; font-weight:bold; color:var(--text)">Agora que analisamos, como você se sente?</p>

            <div class="range-container">
                <div class="range-header">
                    <span>Novo grau de crença no "Deveria":</span>
                    <span id="beliefVal2">0%</span>
                </div>
                <input type="range" id="belief2" min="0" max="100" value="0" oninput="updateRange('belief2', 'beliefVal2')">
            </div>

            <div class="range-container">
                <div class="range-header">
                    <span>Nova intensidade da Emoção:</span>
                    <span id="emotionVal2">0%</span>
                </div>
                <input type="range" id="emotion2" min="0" max="100" value="0" oninput="updateRange('emotion2', 'emotionVal2')">
            </div>

            <div class="nav-buttons">
                <button class="btn btn-prev" onclick="prevStep(3)"><i class="fa-solid fa-arrow-left"></i> Voltar</button>
                <button class="btn btn-next" onclick="showResults()" style="background:#00b894">Ver Resultado <i class="fa-solid fa-check"></i></button>
            </div>
        </div>

        <div class="step" id="stepResult">
            <div class="result-card">
                <i class="fa-solid fa-trophy" style="font-size:3rem; color:#f1c40f; margin-bottom:15px;"></i>
                <h2 style="justify-content: center; border:none; margin-bottom:10px;">Exercício Concluído!</h2>
                <p>Veja como sua perspectiva mudou ao questionar a regra rígida.</p>

                <div class="comparison-grid">
                    <div class="comp-box">
                        <div class="comp-title">Crença Inicial</div>
                        <div class="comp-val" id="res-belief1">80%</div>
                        <div class="comp-label">Rígida</div>
                    </div>
                    <div class="comp-box">
                        <div class="comp-title">Crença Final</div>
                        <div class="comp-val" id="res-belief2" style="color:#00b894">30%</div>
                        <div class="comp-label">Flexível</div>
                    </div>
                </div>

                <div class="transformation-box">
                    <strong><i class="fa-solid fa-shuffle"></i> Nova Perspectiva:</strong><br>
                    <em id="res-preference" style="font-size:1.2rem;">"..."</em>
                </div>

                <div style="margin-top:30px;">
                    <p><strong>Expectativa Razoável:</strong> <span id="res-reasonable">...</span></p>
                </div>

                <button class="btn btn-next" onclick="window.print()" style="margin: 30px auto; background:#2d3436;">
                    <i class="fa-solid fa-print"></i> Salvar / Imprimir
                </button>
                
                <button class="btn btn-prev" onclick="location.reload()" style="margin: 10px auto; background:none; border:1px solid #ccc;">
                    Fazer Novo Exercício
                </button>
            </div>
        </div>

    </div>

    <a href="../listaferramentas.html" class="btn-back-home"><i class="fa-solid fa-arrow-left"></i> Voltar para Ferramentas</a>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init();

        let currentStep = 1;
        const totalSteps = 4;

        function updateRange(inputId, spanId) {
            const val = document.getElementById(inputId).value;
            document.getElementById(spanId).innerText = val + "%";
        }

        function showStep(step) {
            // Oculta todos
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            // Mostra o atual
            document.getElementById(`step${step}`).classList.add('active');
            
            // Atualiza barra
            let percent = (step / (totalSteps + 1)) * 100; // +1 pra considerar o resultado
            if(step > totalSteps) percent = 100; // Resultado
            document.getElementById('progressFill').style.width = percent + "%";
            
            // Scroll para o topo suave
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextStep(step) {
            // Validação simples (opcional, mas boa pra UX)
            if (step === 2) {
                const statement = document.getElementById('statement').value;
                if (!statement) { alert("Por favor, escreva a afirmação 'deveria' antes de continuar."); return; }
            }
            showStep(step);
        }

        function prevStep(step) {
            showStep(step);
        }

        function showResults() {
            // Coleta dados
            const b1 = document.getElementById('belief1').value;
            const b2 = document.getElementById('belief2').value;
            const pref = document.getElementById('preference').value;
            const reas = document.getElementById('reasonable').value;

            // Preenche o card de resultado
            document.getElementById('res-belief1').innerText = b1 + "%";
            document.getElementById('res-belief2').innerText = b2 + "%";
            document.getElementById('res-preference').innerText = pref || "(Não preenchido)";
            document.getElementById('res-reasonable').innerText = reas || "(Não preenchido)";

            // Muda visualmente se houve melhora
            if(parseInt(b2) < parseInt(b1)) {
                document.getElementById('res-belief2').style.color = "#00b894"; // Verde
            } else {
                document.getElementById('res-belief2').style.color = "#d63031"; // Vermelho
            }

            // Mostra tela final
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById('stepResult').classList.add('active');
            document.getElementById('progressFill').style.width = "100%";
        }
    </script>

</body>
</html>
