<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sino da Atenção Plena | Bruno de Souza</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Quicksand:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-gradient: radial-gradient(circle at center, #2c3e50 0%, #000000 100%);
            --bowl-gold: #f1c40f;
            --bowl-shadow: #b7950b;
            --ripple-color: rgba(241, 196, 15, 0.3);
            --text-color: #ecf0f1;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--bg-gradient);
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-color);
            overflow: hidden;
        }

        /* --- AMBIENTE --- */
        .meditation-room {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* --- O SINO (TIGELA) --- */
        .bowl-container {
            position: relative;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 10;
            transition: transform 0.1s;
        }

        .bowl-container:active { transform: scale(0.98); }

        .singing-bowl {
            width: 180px;
            height: 100px;
            background: linear-gradient(135deg, #d4ac0d, #f1c40f, #7d6608);
            border-radius: 0 0 90px 90px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 -10px 20px rgba(0,0,0,0.3);
            border-top: 5px solid #f9e79f;
            z-index: 2;
        }

        /* O Bastão (Visual apenas no hover/click) */
        .striker {
            width: 120px;
            height: 20px;
            background: #8e44ad; /* Madeira/Tecido roxo */
            border-radius: 10px;
            position: absolute;
            top: -20px;
            right: -20px;
            transform: rotate(-45deg);
            opacity: 0;
            transition: opacity 0.3s, transform 0.2s;
            pointer-events: none;
        }

        .bowl-container:hover .striker { opacity: 1; transform: rotate(-45deg) translate(-10px, 10px); }

        /* --- ONDAS DE SOM (RIPPLES) --- */
        .ripple {
            position: absolute;
            border: 2px solid var(--ripple-color);
            border-radius: 50%;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 180px; height: 180px;
            opacity: 0;
            pointer-events: none;
        }

        .ripple.animate {
            animation: expandRipple 4s ease-out forwards;
        }

        @keyframes expandRipple {
            0% { width: 180px; height: 180px; opacity: 0.8; border-width: 5px; }
            100% { width: 600px; height: 600px; opacity: 0; border-width: 0px; }
        }

        /* --- TEXTOS E GUIAS --- */
        .guidance-text {
            margin-top: 60px;
            font-size: 1.5rem;
            text-align: center;
            max-width: 600px;
            height: 80px; /* Reserva espaço */
            opacity: 0.8;
            font-family: 'Cinzel', serif;
            letter-spacing: 1px;
            transition: opacity 1s;
        }

        .sub-guidance {
            font-size: 1rem;
            color: #bdc3c7;
            margin-top: 10px;
            font-style: italic;
        }

        /* --- CONTROLES --- */
        .controls {
            position: absolute;
            bottom: 40px;
            display: flex;
            gap: 20px;
            z-index: 20;
        }

        .btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            transition: 0.3s;
            backdrop-filter: blur(5px);
        }

        .btn:hover { background: rgba(255,255,255,0.2); transform: translateY(-3px); }
        .btn.active { background: var(--bowl-gold); color: #2c3e50; border-color: var(--bowl-gold); }

        .settings-panel {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: #bdc3c7;
        }
        
        input[type="range"] { accent-color: var(--bowl-gold); cursor: pointer; }

    </style>
</head>
<body>

    <div class="meditation-room">
        
        <div id="ripples-container">
            </div>

        <div class="bowl-container" onclick="manualStrike()">
            <div class="singing-bowl"></div>
            <div class="striker"></div>
        </div>

        <div class="guidance-text" id="mainText">Toque no sino para iniciar ou escolha um modo</div>
        <div class="sub-guidance" id="subText">Sinta a vibração se dissipar...</div>

        <div class="controls" style="flex-direction: column; align-items: center;">
            <div class="settings-panel">
                <label><i class="fa-solid fa-clock"></i> Intervalo (seg): <span id="intervalVal">30</span>s</label>
                <input type="range" id="intervalRange" min="10" max="60" value="30" oninput="updateInterval(this.value)">
            </div>

            <div style="display:flex; gap:15px;">
                <button class="btn" onclick="startSession()" id="btnSession"><i class="fa-solid fa-play"></i> Sessão Guiada</button>
                <button class="btn" onclick="stopSession()" id="btnStop" style="display:none;"><i class="fa-solid fa-stop"></i> Parar</button>
            </div>
        </div>

    </div>

    <script>
        // --- WEB AUDIO API (Sintetizador de Sino) ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const ctx = new AudioContext();

        function playBellSound() {
            if (ctx.state === 'suspended') ctx.resume();

            const t = ctx.currentTime;
            
            // Criamos múltiplos osciladores para simular os harmônicos de uma tigela de metal
            const fundamental = 220; // Frequência base (Hz)
            const ratios = [1, 2.7, 5.1, 8.2]; // Harmônicos típicos de sino
            
            ratios.forEach((ratio, index) => {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                
                osc.frequency.value = fundamental * ratio;
                osc.type = index === 0 ? 'sine' : 'triangle'; // Base suave, harmônicos metálicos

                // Envelope de volume (Ataque rápido, Decaimento lento)
                const duration = 8 - index; // Graves duram mais
                gain.gain.setValueAtTime(0, t);
                gain.gain.linearRampToValueAtTime(0.3 / (index + 1), t + 0.05); // Ataque (Strike)
                gain.gain.exponentialRampToValueAtTime(0.001, t + duration); // Decaimento (Ressonância)

                osc.connect(gain);
                gain.connect(ctx.destination);
                
                osc.start(t);
                osc.stop(t + duration);
            });

            createVisualRipple();
        }

        // --- VISUAL ---
        function createVisualRipple() {
            const container = document.getElementById('ripples-container');
            const ripple = document.createElement('div');
            ripple.className = 'ripple animate';
            container.appendChild(ripple);

            // Remove do DOM após animação
            setTimeout(() => {
                ripple.remove();
            }, 4000);
        }

        // --- LÓGICA DA SESSÃO ---
        let sessionInterval = null;
        let countdownTimer = null;
        let intervalSeconds = 30;
        let isSessionActive = false;

        function updateInterval(val) {
            intervalSeconds = val;
            document.getElementById('intervalVal').innerText = val;
        }

        function manualStrike() {
            playBellSound();
            if(!isSessionActive) {
                setText("Ouça o som...", "Siga a vibração até o silêncio total.");
            }
        }

        function setText(main, sub) {
            const m = document.getElementById('mainText');
            const s = document.getElementById('subText');
            m.style.opacity = 0;
            s.style.opacity = 0;
            
            setTimeout(() => {
                m.innerText = main;
                s.innerText = sub;
                m.style.opacity = 1;
                s.style.opacity = 1;
            }, 500);
        }

        function startSession() {
            isSessionActive = true;
            document.getElementById('btnSession').style.display = 'none';
            document.getElementById('btnStop').style.display = 'block';
            document.getElementById('intervalRange').disabled = true;

            // Fase 1: Preparação
            setText("Preparação", "Sente-se com a coluna ereta. Respire.");
            
            setTimeout(() => {
                // Fase 2: Início
                playBellSound();
                setText("Início", "Foque totalmente no som.");
                runCycleLoop();
            }, 5000); // 5s de preparação
        }

        function runCycleLoop() {
            // Define o loop de intervalos
            sessionInterval = setInterval(() => {
                playBellSound();
                setText("Observação", "Perceba o que surge no silêncio.");
            }, intervalSeconds * 1000);
        }

        function stopSession() {
            isSessionActive = false;
            clearInterval(sessionInterval);
            
            // Fase: Encerramento
            playBellSound(); // Último toque
            setText("Encerramento", "Permaneça em silêncio até o som sumir.");

            document.getElementById('btnSession').style.display = 'block';
            document.getElementById('btnStop').style.display = 'none';
            document.getElementById('intervalRange').disabled = false;
        }

    </script>
</body>
</html>
