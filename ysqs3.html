<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YSQ-S3 | Bruno de Souza</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f8f9fa;
            --text: #333;
            --white: #ffffff;
            --high-risk: #c0392b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--white);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 20px;
        }

        h1 { color: var(--primary); margin: 0; font-size: 1.8rem; font-weight: 700; }
        .crp { font-size: 0.9rem; color: #666; margin-top: 5px; }

        .instructions {
            background-color: #e8f4fd;
            border-left: 5px solid var(--accent);
            padding: 15px;
            margin-bottom: 30px;
            font-size: 0.95rem;
            border-radius: 4px;
        }

        .question-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 10px;
            border-bottom: 1px solid #eee;
        }

        .question-row:nth-child(even) { background-color: #fafafa; }

        .q-text { flex: 1; padding-right: 20px; font-size: 0.95rem; }

        input[type="number"] {
            width: 60px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
            color: var(--primary);
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: var(--accent);
            background-color: #f0f8ff;
        }

        .btn-main {
            display: block;
            width: 100%;
            padding: 18px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            transition: background 0.2s;
        }

        .btn-main:hover { background-color: #1a252f; }

        #results-area {
            display: none;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px dashed #ccc;
        }

        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .schema-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .activated {
            background-color: #ffebee;
            color: var(--high-risk);
            font-weight: bold;
            border-left: 4px solid var(--high-risk);
        }

        /* Loading Indicator */
        #loading { text-align: center; padding: 20px; font-size: 1.2rem; color: #666; }

        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; border: none; width: 100%; max-width: 100%; padding: 0; }
            .btn-main, .instructions { display: none; }
            input { border: none; text-align: right; }
            #results-area { display: block !important; break-inside: avoid; }
            canvas { max-height: 500px; margin: 0 auto; }
        }

        @media (max-width: 768px) {
            .results-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>YSQ - S3 (Questionário de Esquemas)</h1>
        <div class="crp">Psicólogo Bruno de Souza - CRP 07/44472</div>
    </header>

    <div class="instructions">
        <strong>Instruções:</strong> Leia as afirmações e pontue de <strong>1 a 6</strong> conforme o quanto ela descreve você no último ano.<br>
        <small>1 = Completamente falso | 6 = Descreve-me perfeitamente</small>
    </div>

    <div id="loading">Carregando as perguntas...</div>
    <div id="questions-container" style="display:none;"></div>

    <button id="btn-calc" class="btn-main" onclick="calcularResultados()" style="display:none;">Calcular e Gerar Gráfico</button>

    <div id="results-area">
        <h2 style="text-align: center; color: var(--primary);">Perfil Esquemático</h2>
        
        <div class="results-grid">
            <div>
                <h3 style="font-size: 1rem; color: #666;">Pontuação Detalhada</h3>
                <div id="text-results"></div>
            </div>
            
            <div>
                <canvas id="schemaChart"></canvas>
            </div>
        </div>

        <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 0.85rem; text-align: center; border: 1px solid #ddd;">
            <strong>Legenda:</strong> Itens em <span style="color:var(--high-risk); font-weight:bold">Vermelho</span> indicam esquemas com pontuação elevada (Soma ≥ 15).<br>
            A interpretação clínica deve considerar o contexto de vida do paciente.
        </div>

        <button class="btn-main" style="background-color: #7f8c8d; margin-top: 20px;" onclick="window.print()">Salvar PDF / Imprimir</button>
    </div>
</div>

<script>
    // --- DADOS ---
    const esquemas = [
        "Privação Emocional", "Abandono", "Desconfiança/Abuso", "Isolamento Social",
        "Defectividade/Vergonha", "Fracasso", "Dependência/Incompetência", 
        "Vulnerabilidade ao Dano", "Emaranhamento", "Subjugação", "Auto-sacrifício",
        "Inibição Emocional", "Padrões Inflexíveis", "Arrogo/Grandiosidade",
        "Autocontrole Insuficiente", "Busca de Aprovação", "Negativismo/Pessimismo", 
        "Postura Punitiva"
    ];

    // Perguntas Sanitizadas (Sem aspas duplas internas)
    const perguntasTexto = [
        "Não tenho tido ninguém que cuide de mim, que partilhe comigo a sua vida ou que se preocupe realmente com tudo o que me acontece.",
        "Costumo apegar-me demasiadamente às pessoas que me são mais próximas porque tenho medo que elas me abandonem.",
        "Sinto que as pessoas vão se aproveitar de mim.",
        "Sou um(a) desajustado(a).",
        "Nenhum homem/mulher de quem eu goste pode gostar de mim depois de conhecer os meus defeitos ou fraquezas.",
        "Quase nada do que faço no trabalho (ou na escola) é tão bom como o que os outros são capazes de fazer.",
        "Não me sinto capaz de me virar sozinho(a) no dia-a-dia.",
        "Não consigo deixar de sentir que alguma coisa de mal está para acontecer.",
        "Não tenho sido capaz de me separar dos meus pais, tal como fazem as outras pessoas da minha idade.",
        "Sinto que, se fizer o que quero, só vou arranjar problemas.",
        "Sou sempre eu que acabo por tomar conta das pessoas que me são mais chegadas.",
        "Sou demasiado controlado(a) para revelar os meus sentimentos positivos aos outros (por ex., afecto, mostrar que me preocupo).",
        "Tenho que ser o(a) melhor em quase tudo o que faço; não aceito ficar em segundo lugar.",
        "Tenho muita dificuldade em aceitar um 'não' por resposta quando quero alguma coisa dos outros.",
        "Não sou capaz de me forçar a ter disciplina suficiente para cumprir tarefas rotineiras ou entediantes.",
        "Ter dinheiro e conhecer pessoas importantes faz-me sentir uma pessoa com valor.",
        "Mesmo quando as coisas parecem estar a correr bem, sinto que isso é apenas temporário.",
        "Se cometer um erro, mereço ser castigado.",
        "Não tenho pessoas que me deem carinho, apoio e afeto.",
        "Preciso tanto dos outros que me preocupo com o facto de os poder perder.",
        "Sinto que tenho sempre que me defender na presença dos outros, caso contrário eles me magoarão intencionalmente.",
        "Sou fundamentalmente diferente dos outros.",
        "Ninguém que me agrade gostaria de ficar comigo depois de me conhecer tal como eu sou na realidade.",
        "Sou um(a) incompetente quando se trata de atingir objetivos ou cumprir uma tarefa no trabalho (ou na escola).",
        "Considero-me uma pessoa dependente relativamente ao que tenho que fazer no dia-a-dia.",
        "Sinto que uma desgraça (natural, criminal, financeira ou médica) pode atingir-me a qualquer momento.",
        "Eu e os meus pais temos tendência a envolvermo-nos demasiado na vida e nos problemas uns dos outros.",
        "Sinto que não tenho outro remédio senão ceder à vontade dos outros, caso contrário, eles irão retaliar, zangar-se ou rejeitar-me de alguma maneira.",
        "Sou uma boa pessoa porque penso mais nos outros do que em mim.",
        "Considero embaraçoso exprimir os meus sentimentos aos outros.",
        "Esforço-me por fazer o melhor não me contento com ser suficientemente bom.",
        "Sou especial e não devia ser obrigado(a) a aceitar muitas das restrições ou limitações que são impostas aos outros.",
        "Se não consigo atingir um objetivo, fico facilmente frustrado(a) e desisto.",
        "Aquilo que consigo alcançar tem mais valor para mim se for algo em que os outros reparem.",
        "Se algo de bom acontecer, preocupa-me que esteja para acontecer algo de mau a seguir.",
        "Se não me esforçar ao máximo, é de esperar que as coisas corram mal.",
        "Tenho sentido que não sou uma pessoa especial para ninguém.",
        "Preocupa-me que as pessoas a que estou ligado(a) me deixem ou me abandonem.",
        "Mais tarde ou mais cedo, acabarei por ser traido(a) por alguém.",
        "Sinto que não pertenço a grupo nenhum; sou um solitário.",
        "Não tenho valor suficiente para merecer o amor, a atenção e o respeito dos outros.",
        "A maioria das pessoas tem mais capacidades do que eu no que diz respeito ao trabalho (ou à escola).",
        "Tenho falta de bom senso.",
        "Preocupa-me poder ser fisicamente agredido por alguém.",
        "É muito difícil, para mim e para os meus pais, termos segredos intimos que não contamos uns aos outros, sem nos sentirmos traídos ou culpados por isso.",
        "Nas minhas relações com os outros deixo que eles me dominem.",
        "Estou tão ocupado(a) a fazer coisas para as pessoas de quem gosto que tenho pouco tempo para mim.",
        "Para mim é difícil ser caloroso(a) e espontâneo(a) com os outros.",
        "Devo de estar à altura de todas as minhas responsabilidades e funções.",
        "Detesto ser reprimido(a) ou impedido(a) de fazer o que quero.",
        "Tenho muita dificuldade em abdicar de uma recompensa ou prazer imediato, a favor de um objectivo a longo prazo.",
        "Sinto-me pouco importante, a não ser que receba muita atenção dos outros.",
        "Todo o cuidado é pouco; quase sempre alguma coisa corre mal.",
        "Se não fizer bem o que me compete, mereço sofrer as consequências.",
        "Não tenho tido ninguém que me ouça atentamente, que me compreenda ou que perceba os meus verdadeiros sentimentos e necessidades.",
        "Quando sinto que alguém de quem eu gosto se está a afastar de mim, sinto-me desesperado.",
        "Sou bastante desconfiado quanto às intenções das outras pessoas.",
        "Sinto-me afastado(a) ou desligado dos outros.",
        "Sinto que nunca poderei ser amado
